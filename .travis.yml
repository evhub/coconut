language: python

sudo: false

notifications:
  email: false

matrix:
  include:

    - python: "2.6"

      install:
        - pip install .
        - git clone https://github.com/evhub/cocotest.git
        - cd cocotest
        - pip install autopep8
        - git clone https://github.com/evhub/prisoner.git
        - git clone https://github.com/evhub/pyston.git
        - pip install futures
        - rm src/cocotest/py35_test.coco
        - rm src/cocotest/py3_test.coco
        - mkdir src_target
        - cp -r src/* src_target
        - rm src/cocotest/py2_test.coco

      script:
        - coconut --version --color cyan
        - coconut --help
        - coconut --strict --display --code "assert '_coconut' in \`globals\`; msg = '<success>'; pmsg = print\$(msg); pmsg()"
        - echo "assert '_coconut' in \`globals\`; msg = '<success>'; pmsg = print\$(msg); pmsg()" | coconut --strict --display
        - python -c "from coconut.convenience import parse; exec(parse('assert \'_coconut\' in \`globals\`; msg = \'<success>\'; pmsg = print\$(msg); pmsg()'))"
        - coconut pyston --recursionlimit 1200
        - coconut prisoner --strict
        - coconut extras.coco --run --strict
        - python extras.py
        - coconut src/runner.coco file_build --strict
        - coconut src/cocotest/__init__.coco file_build/cocotest --strict
        - coconut src/cocotest/main.coco file_build/cocotest --strict
        - coconut src/cocotest/util.coco file_build/cocotest --strict
        - coconut src/cocotest/tutorial.coco file_build/cocotest --strict
        - coconut src_target/cocotest/py2_test.coco file_build/cocotest --strict --target 2.6
        - python file_build/runner.py
        - coconut src file_build --strict --standalone
        - python file_build/runner.py
        - coconut src folder_build --strict
        - coconut src_target/cocotest/py2_test.coco folder_build/cocotest --strict --package --target 2.6
        - python folder_build/runner.py
        - coconut src/runner.coco folder_build --strict --package
        - coconut src/cocotest/__init__.coco folder_build/cocotest --strict --package
        - coconut src/cocotest/main.coco folder_build/cocotest --strict --package
        - coconut src/cocotest/util.coco folder_build/cocotest --strict --package
        - coconut src/cocotest/tutorial.coco folder_build/cocotest --strict --package
        - python folder_build/runner.py
        - mkdir -p run_build/cocotest
        - cp -r folder_build/* run_build
        - cp src/runner.coco run_build
        - pushd run_build
        - coconut --run runner.coco --nowrite --strict
        - coconut --display runner.coco --nowrite --quiet --strict | python
        - popd
        - coconut src force_build --strict --force
        - coconut src_target/cocotest/py2_test.coco force_build/cocotest --strict --package --force --target 2.6
        - python force_build/runner.py
        - coconut src force_build --strict
        - python force_build/runner.py
        - coconut src force_build --strict --force
        - python force_build/runner.py
        - coconut src strictless_build
        - coconut src_target/cocotest/py2_test.coco strictless_build/cocotest --package --target 2.6
        - python strictless_build/runner.py
        - coconut src minify_build --strict --minify
        - coconut src_target/cocotest/py2_test.coco minify_build/cocotest --strict --package --target 2.6 --minify
        - python minify_build/runner.py
        - coconut src linenumbers_build --strict --linenumbers
        - coconut src_target/cocotest/py2_test.coco linenumbers_build/cocotest --strict --package --target 2.6 --linenumbers
        - python linenumbers_build/runner.py
        - coconut src lns_min_build --strict --linenumbers --minify
        - coconut src_target/cocotest/py2_test.coco lns_min_build/cocotest --strict --package --target 2.6 --linenumbers --minify
        - python lns_min_build/runner.py
        - coconut src autopep8_build --strict --autopep8
        - coconut src_target/cocotest/py2_test.coco autopep8_build/cocotest --strict --package --target 2.6 --autopep8
        - python autopep8_build/runner.py
        - coconut src_target sys_build --strict --target sys
        - python sys_build/runner.py
        - coconut src_target target_build --strict --display --target 2.6
        - python target_build/runner.py

    - python: "2.7"

      install:
        - pip install .
        - git clone https://github.com/evhub/cocotest.git
        - cd cocotest
        - pip install autopep8
        - git clone https://github.com/evhub/prisoner.git
        - git clone https://github.com/evhub/pyston.git
        - pip install futures
        - pip install jupyter
        - rm src/cocotest/py35_test.coco
        - rm src/cocotest/py3_test.coco
        - mkdir src_target
        - cp -r src/* src_target
        - rm src/cocotest/py2_test.coco

      script:
        - coconut --version --color cyan
        - coconut --help
        - coconut --strict --display --code "assert '_coconut' in \`globals\`; msg = '<success>'; pmsg = print\$(msg); pmsg()"
        - echo "assert '_coconut' in \`globals\`; msg = '<success>'; pmsg = print\$(msg); pmsg()" | coconut --strict --display
        - python -c "from coconut.convenience import parse; exec(parse('assert \'_coconut\' in \`globals\`; msg = \'<success>\'; pmsg = print\$(msg); pmsg()'))"
        - ipython --ext coconut -c "%coconut assert '_coconut' in \`globals\`; msg = '<success>'; pmsg = print\$(msg); pmsg()"
        - coconut --jupyter
        - coconut pyston --recursionlimit 1200
        - coconut prisoner --strict
        - coconut extras.coco --run --strict
        - python extras.py
        - coconut src/runner.coco file_build --strict
        - coconut src/cocotest/__init__.coco file_build/cocotest --strict
        - coconut src/cocotest/main.coco file_build/cocotest --strict
        - coconut src/cocotest/util.coco file_build/cocotest --strict
        - coconut src/cocotest/tutorial.coco file_build/cocotest --strict
        - coconut src_target/cocotest/py2_test.coco file_build/cocotest --strict --target 2.7
        - python file_build/runner.py
        - coconut src file_build --strict --standalone
        - python file_build/runner.py
        - coconut src folder_build --strict
        - coconut src_target/cocotest/py2_test.coco folder_build/cocotest --strict --package --target 2.7
        - python folder_build/runner.py
        - coconut src/runner.coco folder_build --strict --package
        - coconut src/cocotest/__init__.coco folder_build/cocotest --strict --package
        - coconut src/cocotest/main.coco folder_build/cocotest --strict --package
        - coconut src/cocotest/util.coco folder_build/cocotest --strict --package
        - coconut src/cocotest/tutorial.coco folder_build/cocotest --strict --package
        - python folder_build/runner.py
        - mkdir -p run_build/cocotest
        - cp -r folder_build/* run_build
        - cp src/runner.coco run_build
        - pushd run_build
        - coconut --run runner.coco --nowrite --strict
        - coconut --display runner.coco --nowrite --quiet --strict | python
        - popd
        - coconut src force_build --strict --force
        - coconut src_target/cocotest/py2_test.coco force_build/cocotest --strict --package --force --target 2.7
        - python force_build/runner.py
        - coconut src force_build --strict
        - python force_build/runner.py
        - coconut src force_build --strict --force
        - python force_build/runner.py
        - coconut src strictless_build
        - coconut src_target/cocotest/py2_test.coco strictless_build/cocotest --package --target 2.7
        - python strictless_build/runner.py
        - coconut src minify_build --strict --minify
        - coconut src_target/cocotest/py2_test.coco minify_build/cocotest --strict --package --target 2.7 --minify
        - python minify_build/runner.py
        - coconut src linenumbers_build --strict --linenumbers
        - coconut src_target/cocotest/py2_test.coco linenumbers_build/cocotest --strict --package --target 2.7 --linenumbers
        - python linenumbers_build/runner.py
        - coconut src lns_min_build --strict --linenumbers --minify
        - coconut src_target/cocotest/py2_test.coco lns_min_build/cocotest --strict --package --target 2.7 --linenumbers --minify
        - python lns_min_build/runner.py
        - coconut src autopep8_build --strict --autopep8
        - coconut src_target/cocotest/py2_test.coco autopep8_build/cocotest --strict --package --target 2.7 --autopep8
        - python autopep8_build/runner.py
        - coconut src_target sys_build --strict --target sys
        - python sys_build/runner.py
        - coconut src_target target_build --strict --display --target 2.7
        - python target_build/runner.py

    - python: "pypy"

      install:
        - pip install .
        - git clone https://github.com/evhub/cocotest.git
        - cd cocotest
        - pip install autopep8
        - git clone https://github.com/evhub/prisoner.git
        - git clone https://github.com/evhub/pyston.git
        - pip install futures
        - pip install jupyter
        - rm src/cocotest/py35_test.coco
        - rm src/cocotest/py3_test.coco
        - mkdir src_target
        - cp -r src/* src_target
        - rm src/cocotest/py2_test.coco

      script:
        - coconut --version --color cyan
        - coconut --help
        - coconut --strict --display --code "assert '_coconut' in \`globals\`; msg = '<success>'; pmsg = print\$(msg); pmsg()"
        - echo "assert '_coconut' in \`globals\`; msg = '<success>'; pmsg = print\$(msg); pmsg()" | coconut --strict --display
        - python -c "from coconut.convenience import parse; exec(parse('assert \'_coconut\' in \`globals\`; msg = \'<success>\'; pmsg = print\$(msg); pmsg()'))"
        - ipython --ext coconut -c "%coconut assert '_coconut' in \`globals\`; msg = '<success>'; pmsg = print\$(msg); pmsg()"
        - coconut --jupyter
        - coconut pyston
        - pushd pyston
        - python runner.py
        - popd
        - coconut prisoner --strict
        - coconut extras.coco --run --strict
        - python extras.py
        - coconut src/runner.coco file_build --strict
        - coconut src/cocotest/__init__.coco file_build/cocotest --strict
        - coconut src/cocotest/main.coco file_build/cocotest --strict
        - coconut src/cocotest/util.coco file_build/cocotest --strict
        - coconut src/cocotest/tutorial.coco file_build/cocotest --strict
        - coconut src_target/cocotest/py2_test.coco file_build/cocotest --strict --target 2.7
        - python file_build/runner.py
        - coconut src file_build --strict --standalone
        - python file_build/runner.py
        - coconut src folder_build --strict
        - coconut src_target/cocotest/py2_test.coco folder_build/cocotest --strict --package --target 2.7
        - python folder_build/runner.py
        - coconut src/runner.coco folder_build --strict --package
        - coconut src/cocotest/__init__.coco folder_build/cocotest --strict --package
        - coconut src/cocotest/main.coco folder_build/cocotest --strict --package
        - coconut src/cocotest/util.coco folder_build/cocotest --strict --package
        - coconut src/cocotest/tutorial.coco folder_build/cocotest --strict --package
        - python folder_build/runner.py
        - mkdir -p run_build/cocotest
        - cp -r folder_build/* run_build
        - cp src/runner.coco run_build
        - pushd run_build
        - coconut --run runner.coco --nowrite --strict
        - coconut --display runner.coco --nowrite --quiet --strict | python
        - popd
        - coconut src force_build --strict --force
        - coconut src_target/cocotest/py2_test.coco force_build/cocotest --strict --package --force --target 2.7
        - python force_build/runner.py
        - coconut src force_build --strict
        - python force_build/runner.py
        - coconut src force_build --strict --force
        - python force_build/runner.py
        - coconut src strictless_build
        - coconut src_target/cocotest/py2_test.coco strictless_build/cocotest --package --target 2.7
        - python strictless_build/runner.py
        - coconut src minify_build --strict --minify
        - coconut src_target/cocotest/py2_test.coco minify_build/cocotest --strict --package --target 2.7 --minify
        - python minify_build/runner.py
        - coconut src linenumbers_build --strict --linenumbers
        - coconut src_target/cocotest/py2_test.coco linenumbers_build/cocotest --strict --package --target 2.7 --linenumbers
        - python linenumbers_build/runner.py
        - coconut src lns_min_build --strict --linenumbers --minify
        - coconut src_target/cocotest/py2_test.coco lns_min_build/cocotest --strict --package --target 2.7 --linenumbers --minify
        - python lns_min_build/runner.py
        - coconut src autopep8_build --strict --autopep8
        - coconut src_target/cocotest/py2_test.coco autopep8_build/cocotest --strict --package --target 2.7 --autopep8
        - python autopep8_build/runner.py
        - coconut src_target sys_build --strict --target sys
        - python sys_build/runner.py
        - coconut src_target target_build --strict --display --target 2.7
        - python target_build/runner.py

    - python: "3.2"

      install:
        - pip install .
        - git clone https://github.com/evhub/cocotest.git
        - cd cocotest
        - pip install autopep8
        - git clone https://github.com/evhub/prisoner.git
        - git clone https://github.com/evhub/pyston.git
        - rm src/cocotest/py35_test.coco
        - rm src/cocotest/py2_test.coco
        - mkdir src_target
        - cp -r src/* src_target
        - rm src/cocotest/py3_test.coco

      script:
        - coconut --version --color cyan
        - coconut --help
        - coconut --strict --display --code "assert '_coconut' in \`globals\`; msg = '<success>'; pmsg = print\$(msg); pmsg()"
        - echo "assert '_coconut' in \`globals\`; msg = '<success>'; pmsg = print\$(msg); pmsg()" | coconut --strict --display
        - python -c "from coconut.convenience import parse; exec(parse('assert \'_coconut\' in \`globals\`; msg = \'<success>\'; pmsg = print\$(msg); pmsg()'))"
        - coconut pyston --recursionlimit 1200
        - coconut prisoner --strict
        - coconut extras.coco --run --strict
        - python extras.py
        - coconut src/runner.coco file_build --strict
        - coconut src/cocotest/__init__.coco file_build/cocotest --strict
        - coconut src/cocotest/main.coco file_build/cocotest --strict
        - coconut src/cocotest/util.coco file_build/cocotest --strict
        - coconut src/cocotest/tutorial.coco file_build/cocotest --strict
        - coconut src_target/cocotest/py3_test.coco file_build/cocotest --strict --target 3.2
        - python file_build/runner.py
        - coconut src file_build --strict --standalone
        - python file_build/runner.py
        - coconut src folder_build --strict
        - coconut src_target/cocotest/py3_test.coco folder_build/cocotest --strict --package --target 3.2
        - python folder_build/runner.py
        - coconut src/runner.coco folder_build --strict --package
        - coconut src/cocotest/__init__.coco folder_build/cocotest --strict --package
        - coconut src/cocotest/main.coco folder_build/cocotest --strict --package
        - coconut src/cocotest/util.coco folder_build/cocotest --strict --package
        - coconut src/cocotest/tutorial.coco folder_build/cocotest --strict --package
        - python folder_build/runner.py
        - mkdir -p run_build/cocotest
        - cp -r folder_build/* run_build
        - cp src/runner.coco run_build
        - pushd run_build
        - coconut --run runner.coco --nowrite --strict
        - coconut --display runner.coco --nowrite --quiet --strict | python
        - popd
        - coconut src force_build --strict --force
        - coconut src_target/cocotest/py3_test.coco force_build/cocotest --strict --package --force --target 3.2
        - python force_build/runner.py
        - coconut src force_build --strict
        - python force_build/runner.py
        - coconut src force_build --strict --force
        - python force_build/runner.py
        - coconut src strictless_build
        - coconut src_target/cocotest/py3_test.coco strictless_build/cocotest --package --target 3.2
        - python strictless_build/runner.py
        - coconut src minify_build --strict --minify
        - coconut src_target/cocotest/py3_test.coco minify_build/cocotest --strict --package --target 3.2 --minify
        - python minify_build/runner.py
        - coconut src linenumbers_build --strict --linenumbers
        - coconut src_target/cocotest/py3_test.coco linenumbers_build/cocotest --strict --package --target 3.2 --linenumbers
        - python linenumbers_build/runner.py
        - coconut src lns_min_build --strict --linenumbers --minify
        - coconut src_target/cocotest/py3_test.coco lns_min_build/cocotest --strict --package --target 3.2 --linenumbers --minify
        - python lns_min_build/runner.py
        - coconut src autopep8_build --strict --autopep8
        - coconut src_target/cocotest/py3_test.coco autopep8_build/cocotest --strict --package --target 3.2 --autopep8
        - python autopep8_build/runner.py
        - coconut src_target sys_build --strict --target sys
        - python sys_build/runner.py
        - coconut src_target target_build --strict --display --target 3.2
        - python target_build/runner.py

    - python: "3.3"

      install:
        - pip install .
        - git clone https://github.com/evhub/cocotest.git
        - cd cocotest
        - pip install autopep8
        - git clone https://github.com/evhub/prisoner.git
        - git clone https://github.com/evhub/pyston.git
        - pip install jupyter
        - rm src/cocotest/py35_test.coco
        - rm src/cocotest/py2_test.coco
        - mkdir src_target
        - cp -r src/* src_target
        - rm src/cocotest/py3_test.coco

      script:
        - coconut --version --color cyan
        - coconut --help
        - coconut --strict --display --code "assert '_coconut' in \`globals\`; msg = '<success>'; pmsg = print\$(msg); pmsg()"
        - echo "assert '_coconut' in \`globals\`; msg = '<success>'; pmsg = print\$(msg); pmsg()" | coconut --strict --display
        - python -c "from coconut.convenience import parse; exec(parse('assert \'_coconut\' in \`globals\`; msg = \'<success>\'; pmsg = print\$(msg); pmsg()'))"
        - ipython --ext coconut -c "%coconut assert '_coconut' in \`globals\`; msg = '<success>'; pmsg = print\$(msg); pmsg()"
        - coconut --jupyter
        - coconut pyston --recursionlimit 1200
        - coconut prisoner --strict
        - coconut extras.coco --run --strict
        - python extras.py
        - coconut src/runner.coco file_build --strict
        - coconut src/cocotest/__init__.coco file_build/cocotest --strict
        - coconut src/cocotest/main.coco file_build/cocotest --strict
        - coconut src/cocotest/util.coco file_build/cocotest --strict
        - coconut src/cocotest/tutorial.coco file_build/cocotest --strict
        - coconut src_target/cocotest/py3_test.coco file_build/cocotest --strict --target 3.3
        - python file_build/runner.py
        - coconut src file_build --strict --standalone
        - python file_build/runner.py
        - coconut src folder_build --strict
        - coconut src_target/cocotest/py3_test.coco folder_build/cocotest --strict --package --target 3.3
        - python folder_build/runner.py
        - coconut src/runner.coco folder_build --strict --package
        - coconut src/cocotest/__init__.coco folder_build/cocotest --strict --package
        - coconut src/cocotest/main.coco folder_build/cocotest --strict --package
        - coconut src/cocotest/util.coco folder_build/cocotest --strict --package
        - coconut src/cocotest/tutorial.coco folder_build/cocotest --strict --package
        - python folder_build/runner.py
        - mkdir -p run_build/cocotest
        - cp -r folder_build/* run_build
        - cp src/runner.coco run_build
        - pushd run_build
        - coconut --run runner.coco --nowrite --strict
        - coconut --display runner.coco --nowrite --quiet --strict | python
        - popd
        - coconut src force_build --strict --force
        - coconut src_target/cocotest/py3_test.coco force_build/cocotest --strict --package --force --target 3.3
        - python force_build/runner.py
        - coconut src force_build --strict
        - python force_build/runner.py
        - coconut src force_build --strict --force
        - python force_build/runner.py
        - coconut src strictless_build
        - coconut src_target/cocotest/py3_test.coco strictless_build/cocotest --package --target 3.3
        - python strictless_build/runner.py
        - coconut src minify_build --strict --minify
        - coconut src_target/cocotest/py3_test.coco minify_build/cocotest --strict --package --target 3.3 --minify
        - python minify_build/runner.py
        - coconut src linenumbers_build --strict --linenumbers
        - coconut src_target/cocotest/py3_test.coco linenumbers_build/cocotest --strict --package --target 3.3 --linenumbers
        - python linenumbers_build/runner.py
        - coconut src lns_min_build --strict --linenumbers --minify
        - coconut src_target/cocotest/py3_test.coco lns_min_build/cocotest --strict --package --target 3.3 --linenumbers --minify
        - python lns_min_build/runner.py
        - coconut src autopep8_build --strict --autopep8
        - coconut src_target/cocotest/py3_test.coco autopep8_build/cocotest --strict --package --target 3.3 --autopep8
        - python autopep8_build/runner.py
        - coconut src_target sys_build --strict --target sys
        - python sys_build/runner.py
        - coconut src_target target_build --strict --display --target 3.3
        - python target_build/runner.py

    - python: "3.4"

      install:
        - pip install .
        - git clone https://github.com/evhub/cocotest.git
        - cd cocotest
        - pip install autopep8
        - git clone https://github.com/evhub/prisoner.git
        - git clone https://github.com/evhub/pyston.git
        - pip install jupyter
        - rm src/cocotest/py35_test.coco
        - rm src/cocotest/py2_test.coco
        - mkdir src_target
        - cp -r src/* src_target
        - rm src/cocotest/py3_test.coco

      script:
        - coconut --version --color cyan
        - coconut --help
        - coconut --strict --display --code "assert '_coconut' in \`globals\`; msg = '<success>'; pmsg = print\$(msg); pmsg()"
        - echo "assert '_coconut' in \`globals\`; msg = '<success>'; pmsg = print\$(msg); pmsg()" | coconut --strict --display
        - python -c "from coconut.convenience import parse; exec(parse('assert \'_coconut\' in \`globals\`; msg = \'<success>\'; pmsg = print\$(msg); pmsg()'))"
        - ipython --ext coconut -c "%coconut assert '_coconut' in \`globals\`; msg = '<success>'; pmsg = print\$(msg); pmsg()"
        - coconut --jupyter
        - coconut pyston --recursionlimit 1200
        - coconut prisoner --strict
        - coconut extras.coco --run --strict
        - python extras.py
        - coconut src/runner.coco file_build --strict
        - coconut src/cocotest/__init__.coco file_build/cocotest --strict
        - coconut src/cocotest/main.coco file_build/cocotest --strict
        - coconut src/cocotest/util.coco file_build/cocotest --strict
        - coconut src/cocotest/tutorial.coco file_build/cocotest --strict
        - coconut src_target/cocotest/py3_test.coco file_build/cocotest --strict --target 3.4
        - python file_build/runner.py
        - coconut src file_build --strict --standalone
        - python file_build/runner.py
        - coconut src folder_build --strict
        - coconut src_target/cocotest/py3_test.coco folder_build/cocotest --strict --package --target 3.4
        - python folder_build/runner.py
        - coconut src/runner.coco folder_build --strict --package
        - coconut src/cocotest/__init__.coco folder_build/cocotest --strict --package
        - coconut src/cocotest/main.coco folder_build/cocotest --strict --package
        - coconut src/cocotest/util.coco folder_build/cocotest --strict --package
        - coconut src/cocotest/tutorial.coco folder_build/cocotest --strict --package
        - python folder_build/runner.py
        - mkdir -p run_build/cocotest
        - cp -r folder_build/* run_build
        - cp src/runner.coco run_build
        - pushd run_build
        - coconut --run runner.coco --nowrite --strict
        - coconut --display runner.coco --nowrite --quiet --strict | python
        - popd
        - coconut src force_build --strict --force
        - coconut src_target/cocotest/py3_test.coco force_build/cocotest --strict --package --force --target 3.4
        - python force_build/runner.py
        - coconut src force_build --strict
        - python force_build/runner.py
        - coconut src force_build --strict --force
        - python force_build/runner.py
        - coconut src strictless_build
        - coconut src_target/cocotest/py3_test.coco strictless_build/cocotest --package --target 3.4
        - python strictless_build/runner.py
        - coconut src minify_build --strict --minify
        - coconut src_target/cocotest/py3_test.coco minify_build/cocotest --strict --package --target 3.4 --minify
        - python minify_build/runner.py
        - coconut src linenumbers_build --strict --linenumbers
        - coconut src_target/cocotest/py3_test.coco linenumbers_build/cocotest --strict --package --target 3.4 --linenumbers
        - python linenumbers_build/runner.py
        - coconut src lns_min_build --strict --linenumbers --minify
        - coconut src_target/cocotest/py3_test.coco lns_min_build/cocotest --strict --package --target 3.4 --linenumbers --minify
        - python lns_min_build/runner.py
        - coconut src autopep8_build --strict --autopep8
        - coconut src_target/cocotest/py3_test.coco autopep8_build/cocotest --strict --package --target 3.4 --autopep8
        - python autopep8_build/runner.py
        - coconut src_target sys_build --strict --target sys
        - python sys_build/runner.py
        - coconut src_target target_build --strict --display --target 3.4
        - python target_build/runner.py

    - python: "3.5"

      install:
        - pip install .
        - git clone https://github.com/evhub/cocotest.git
        - cd cocotest
        - pip install autopep8
        - git clone https://github.com/evhub/prisoner.git
        - git clone https://github.com/evhub/pyston.git
        - pip install jupyter
        - rm src/cocotest/py2_test.coco
        - mkdir src_target
        - cp -r src/* src_target
        - rm src/cocotest/py3_test.coco
        - rm src/cocotest/py35_test.coco

      script:
        - coconut --version --color cyan
        - coconut --help
        - coconut --strict --display --code "assert '_coconut' in \`globals\`; msg = '<success>'; pmsg = print\$(msg); pmsg()"
        - echo "assert '_coconut' in \`globals\`; msg = '<success>'; pmsg = print\$(msg); pmsg()" | coconut --strict --display
        - python -c "from coconut.convenience import parse; exec(parse('assert \'_coconut\' in \`globals\`; msg = \'<success>\'; pmsg = print\$(msg); pmsg()'))"
        - ipython --ext coconut -c "%coconut assert '_coconut' in \`globals\`; msg = '<success>'; pmsg = print\$(msg); pmsg()"
        - coconut --jupyter
        - coconut pyston --recursionlimit 1200
        - coconut prisoner --strict
        - coconut extras.coco --run --strict
        - python extras.py
        - coconut src/runner.coco file_build --strict
        - coconut src/cocotest/__init__.coco file_build/cocotest --strict
        - coconut src/cocotest/main.coco file_build/cocotest --strict
        - coconut src/cocotest/util.coco file_build/cocotest --strict
        - coconut src/cocotest/tutorial.coco file_build/cocotest --strict
        - coconut src_target/cocotest/py3_test.coco file_build/cocotest --strict --target 3.5
        - coconut src_target/cocotest/py35_test.coco file_build/cocotest --strict --target 3.5
        - python file_build/runner.py
        - coconut src file_build --strict --standalone
        - python file_build/runner.py
        - coconut src folder_build --strict
        - coconut src_target/cocotest/py3_test.coco folder_build/cocotest --strict --package --target 3.5
        - coconut src_target/cocotest/py35_test.coco folder_build/cocotest --strict --package --target 3.5
        - python folder_build/runner.py
        - coconut src/runner.coco folder_build --strict --package
        - coconut src/cocotest/__init__.coco folder_build/cocotest --strict --package
        - coconut src/cocotest/main.coco folder_build/cocotest --strict --package
        - coconut src/cocotest/util.coco folder_build/cocotest --strict --package
        - coconut src/cocotest/tutorial.coco folder_build/cocotest --strict --package
        - python folder_build/runner.py
        - mkdir -p run_build/cocotest
        - cp -r folder_build/* run_build
        - cp src/runner.coco run_build
        - pushd run_build
        - coconut --run runner.coco --nowrite --strict
        - coconut --display runner.coco --nowrite --quiet --strict | python
        - popd
        - coconut src force_build --strict --force
        - coconut src_target/cocotest/py3_test.coco force_build/cocotest --strict --package --force --target 3.5
        - coconut src_target/cocotest/py35_test.coco force_build/cocotest --strict --package --force --target 3.5
        - python force_build/runner.py
        - coconut src force_build --strict
        - python force_build/runner.py
        - coconut src force_build --strict --force
        - python force_build/runner.py
        - coconut src strictless_build
        - coconut src_target/cocotest/py3_test.coco strictless_build/cocotest --package --target 3.5
        - coconut src_target/cocotest/py35_test.coco strictless_build/cocotest --package --target 3.5
        - python strictless_build/runner.py
        - coconut src minify_build --strict --minify
        - coconut src_target/cocotest/py3_test.coco minify_build/cocotest --strict --package --target 3.5 --minify
        - coconut src_target/cocotest/py35_test.coco minify_build/cocotest --strict --package --target 3.5 --minify
        - python minify_build/runner.py
        - coconut src linenumbers_build --strict --linenumbers
        - coconut src_target/cocotest/py3_test.coco linenumbers_build/cocotest --strict --package --target 3.5 --linenumbers
        - coconut src_target/cocotest/py35_test.coco linenumbers_build/cocotest --strict --package --target 3.5 --linenumbers
        - python linenumbers_build/runner.py
        - coconut src lns_min_build --strict --linenumbers --minify
        - coconut src_target/cocotest/py3_test.coco lns_min_build/cocotest --strict --package --target 3.5 --linenumbers --minify
        - coconut src_target/cocotest/py35_test.coco lns_min_build/cocotest --strict --package --target 3.5 --linenumbers --minify
        - python lns_min_build/runner.py
        - coconut src autopep8_build --strict --autopep8
        - coconut src_target/cocotest/py3_test.coco autopep8_build/cocotest --strict --package --target 3.5 --autopep8
        - coconut src_target/cocotest/py35_test.coco autopep8_build/cocotest --strict --package --target 3.5 --autopep8
        - python autopep8_build/runner.py
        - coconut src_target sys_build --strict --target sys
        - python sys_build/runner.py
        - coconut src_target target_build --strict --display --target 3.5
        - python target_build/runner.py

    - python: "pypy3"

      install:
        - pip install .
        - git clone https://github.com/evhub/cocotest.git
        - cd cocotest
        - pip install autopep8
        - git clone https://github.com/evhub/prisoner.git
        - git clone https://github.com/evhub/pyston.git
        - rm src/cocotest/py35_test.coco
        - rm src/cocotest/py2_test.coco
        - mkdir src_target
        - cp -r src/* src_target
        - rm src/cocotest/py3_test.coco

      script:
        - coconut --version --color cyan
        - coconut --help
        - coconut --strict --display --code "assert '_coconut' in \`globals\`; msg = '<success>'; pmsg = print\$(msg); pmsg()"
        - echo "assert '_coconut' in \`globals\`; msg = '<success>'; pmsg = print\$(msg); pmsg()" | coconut --strict --display
        - python -c "from coconut.convenience import parse; exec(parse('assert \'_coconut\' in \`globals\`; msg = \'<success>\'; pmsg = print\$(msg); pmsg()'))"
        - coconut pyston
        - coconut prisoner --strict
        - coconut extras.coco --run --strict
        - python extras.py
        - coconut src/runner.coco file_build --strict
        - coconut src/cocotest/__init__.coco file_build/cocotest --strict
        - coconut src/cocotest/main.coco file_build/cocotest --strict
        - coconut src/cocotest/util.coco file_build/cocotest --strict
        - coconut src/cocotest/tutorial.coco file_build/cocotest --strict
        - coconut src_target/cocotest/py3_test.coco file_build/cocotest --strict --target 3.2
        - python file_build/runner.py
        - coconut src file_build --strict --standalone
        - python file_build/runner.py
        - coconut src folder_build --strict
        - coconut src_target/cocotest/py3_test.coco folder_build/cocotest --strict --package --target 3.2
        - python folder_build/runner.py
        - coconut src/runner.coco folder_build --strict --package
        - coconut src/cocotest/__init__.coco folder_build/cocotest --strict --package
        - coconut src/cocotest/main.coco folder_build/cocotest --strict --package
        - coconut src/cocotest/util.coco folder_build/cocotest --strict --package
        - coconut src/cocotest/tutorial.coco folder_build/cocotest --strict --package
        - python folder_build/runner.py
        - mkdir -p run_build/cocotest
        - cp -r folder_build/* run_build
        - cp src/runner.coco run_build
        - pushd run_build
        - coconut --run runner.coco --nowrite --strict
        - coconut --display runner.coco --nowrite --quiet --strict | python
        - popd
        - coconut src force_build --strict --force
        - coconut src_target/cocotest/py3_test.coco force_build/cocotest --strict --package --force --target 3.2
        - python force_build/runner.py
        - coconut src force_build --strict
        - python force_build/runner.py
        - coconut src force_build --strict --force
        - python force_build/runner.py
        - coconut src strictless_build
        - coconut src_target/cocotest/py3_test.coco strictless_build/cocotest --package --target 3.2
        - python strictless_build/runner.py
        - coconut src minify_build --strict --minify
        - coconut src_target/cocotest/py3_test.coco minify_build/cocotest --strict --package --target 3.2 --minify
        - python minify_build/runner.py
        - coconut src linenumbers_build --strict --linenumbers
        - coconut src_target/cocotest/py3_test.coco linenumbers_build/cocotest --strict --package --target 3.2 --linenumbers
        - python linenumbers_build/runner.py
        - coconut src lns_min_build --strict --linenumbers --minify
        - coconut src_target/cocotest/py3_test.coco lns_min_build/cocotest --strict --package --target 3.2 --linenumbers --minify
        - python lns_min_build/runner.py
        - coconut src autopep8_build --strict --autopep8
        - coconut src_target/cocotest/py3_test.coco autopep8_build/cocotest --strict --package --target 3.2 --autopep8
        - python autopep8_build/runner.py
        - coconut src_target sys_build --strict --target sys
        - python sys_build/runner.py
        - coconut src_target target_build --strict --display --target 3.2
        - python target_build/runner.py
